
<%= javascript_include_tag('heatmap.js') %>
<div class="container-show-crops">
    <ul class="left-ul">
        <li class="updateHeatmapButton" data-crop-id="1"><a class="left-a">Cultivo 1</a></li>
        <li class="updateHeatmapButton" data-crop-id="2"><a class="left-a">Cultivo 2</a></li>
        <li class="updateHeatmapButton" data-crop-id="3"><a class="left-a">Cultivo 3</a></li>
    </ul>

    
<div class="heat-map">
    <h2 id="crop-title" style="color:#012970">Cultivo 1</h2>
    <div id="heatmapContainer" style="width: 60vw; height: 50vh; border: 3.5px solid #012970; border-radius: 5px;"></div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        var heatmapContainer = document.getElementById('heatmapContainer');
        var heatmap = h337.create({
        container: heatmapContainer,
        radius: 100, 
        maxOpacity: .6,
        minOpacity: 0, 
        blur: .75
        });
        function updateHeatmap(cropId) {
            fetch(`/crops/${cropId}/heatmap_data.json`)
                .then(response => response.json())
                .then(data => {
                title = document.getElementById('crop-title');
                console.log(title.innerHTML);
                title.innerHTML = `Cultivo ${cropId}`
                heatmap.setData({
                    max: 100, // maximo valor posible
                    data: data
                });
                })
                .catch(error => console.error('Error fetching data: ', error));
            }

            // Añadir event listeners para cada botón de cultivo
            document.querySelectorAll('.updateHeatmapButton').forEach(button => {
            button.addEventListener('click', function() {
                updateHeatmap(this.dataset.cropId);
            });
        });
    });
    </script>
</div>
